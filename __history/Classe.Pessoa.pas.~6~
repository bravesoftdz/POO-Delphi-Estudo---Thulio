unit Classe.Pessoa;

interface

uses
  System.SysUtils, Classe.SQL;

type
  TPessoa = class
    private
      FNome : String;
      procedure setNome(Value : String);
      function getNome : String;

    public
      DataNasc : String;
      Sexo : String;
      Etnia : String;
      SQL : TConSQL;
      property Nome : String read getNome write setNome;
      function Idade : Integer;

  end;

implementation

{ TPessoa }

function TPessoa.Idade : Integer;
begin
  Result := Trunc((now - StrToDate(DataNasc)) / 365.25);
end;

function TPessoa.getNome : String;
begin
  Result := FNome;
end;

procedure TPessoa.setNome(Value : String);
begin
  if Value = '' then
    raise Exception.Create('Valor não pode ser vazio');

  FNome := Value;
end;

end.
